(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(e){if(e.ep)return;e.ep=!0;const n=i(e);fetch(e.href,n)}})();class r{constructor(){this.isRunning=!1,this.isPaused=!1,this.isWorkSession=!0,this.timeLeft=25*60,this.completedSessions=0,this.timer=null,this.initElements(),this.initEventListeners(),this.updateDisplay(),this.loadSettings()}initElements(){this.minutesEl=document.getElementById("minutes"),this.secondsEl=document.getElementById("seconds"),this.timerLabelEl=document.getElementById("timer-label"),this.startBtn=document.getElementById("start-btn"),this.pauseBtn=document.getElementById("pause-btn"),this.resetBtn=document.getElementById("reset-btn"),this.workTimeInput=document.getElementById("work-time"),this.breakTimeInput=document.getElementById("break-time"),this.completedSessionsEl=document.getElementById("completed-sessions"),this.timerDisplay=document.querySelector(".timer-display")}initEventListeners(){this.startBtn.addEventListener("click",()=>this.start()),this.pauseBtn.addEventListener("click",()=>this.pause()),this.resetBtn.addEventListener("click",()=>this.reset()),this.workTimeInput.addEventListener("change",()=>this.updateWorkTime()),this.breakTimeInput.addEventListener("change",()=>this.updateBreakTime()),document.addEventListener("visibilitychange",()=>{if(document.hidden&&this.isRunning)this.lastTime=Date.now();else if(!document.hidden&&this.isRunning&&this.lastTime){const t=Math.floor((Date.now()-this.lastTime)/1e3);this.timeLeft=Math.max(0,this.timeLeft-t),this.updateDisplay(),this.timeLeft===0&&this.complete()}})}start(){this.isPaused&&(this.isPaused=!1),this.isRunning=!0,this.startBtn.disabled=!0,this.pauseBtn.disabled=!1,this.timerDisplay.classList.add("running"),this.timer=setInterval(()=>{this.timeLeft--,this.updateDisplay(),this.timeLeft<=60&&this.timeLeft>0&&this.timerDisplay.classList.add("warning"),this.timeLeft<=0&&this.complete()},1e3)}pause(){this.isPaused=!0,this.isRunning=!1,this.startBtn.disabled=!1,this.pauseBtn.disabled=!0,this.timerDisplay.classList.remove("running"),clearInterval(this.timer)}reset(){this.isRunning=!1,this.isPaused=!1,this.startBtn.disabled=!1,this.pauseBtn.disabled=!0,this.timerDisplay.classList.remove("running","warning"),clearInterval(this.timer),this.isWorkSession?this.timeLeft=parseInt(this.workTimeInput.value)*60:this.timeLeft=parseInt(this.breakTimeInput.value)*60,this.updateDisplay()}complete(){this.isRunning=!1,this.startBtn.disabled=!1,this.pauseBtn.disabled=!0,this.timerDisplay.classList.remove("running","warning"),clearInterval(this.timer),this.notify(),this.isWorkSession?(this.completedSessions++,this.completedSessionsEl.textContent=this.completedSessions,this.saveStats(),this.isWorkSession=!1,this.timeLeft=parseInt(this.breakTimeInput.value)*60,this.timerLabelEl.textContent="휴식 시간"):(this.isWorkSession=!0,this.timeLeft=parseInt(this.workTimeInput.value)*60,this.timerLabelEl.textContent="집중 시간"),this.updateDisplay()}notify(){if("Notification"in window&&Notification.permission==="granted"){const t=this.isWorkSession?"휴식 시간입니다!":"집중 시간입니다!";new Notification("포모도로 타이머",{body:t,icon:"🍅"})}"vibrate"in navigator&&navigator.vibrate([200,100,200]),this.playBeep()}playBeep(){const t=new(window.AudioContext||window.webkitAudioContext),i=t.createOscillator(),s=t.createGain();i.connect(s),s.connect(t.destination),i.frequency.value=800,i.type="sine",s.gain.setValueAtTime(.3,t.currentTime),s.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),i.start(t.currentTime),i.stop(t.currentTime+.5)}updateDisplay(){const t=Math.floor(this.timeLeft/60),i=this.timeLeft%60;this.minutesEl.textContent=t.toString().padStart(2,"0"),this.secondsEl.textContent=i.toString().padStart(2,"0")}updateWorkTime(){this.isWorkSession&&!this.isRunning&&(this.timeLeft=parseInt(this.workTimeInput.value)*60,this.updateDisplay()),this.saveSettings()}updateBreakTime(){!this.isWorkSession&&!this.isRunning&&(this.timeLeft=parseInt(this.breakTimeInput.value)*60,this.updateDisplay()),this.saveSettings()}saveSettings(){localStorage.setItem("pomodoroSettings",JSON.stringify({workTime:this.workTimeInput.value,breakTime:this.breakTimeInput.value}))}loadSettings(){const t=localStorage.getItem("pomodoroSettings");if(t){const s=JSON.parse(t);this.workTimeInput.value=s.workTime,this.breakTimeInput.value=s.breakTime,this.timeLeft=parseInt(s.workTime)*60,this.updateDisplay()}const i=localStorage.getItem("pomodoroStats");i&&(this.completedSessions=parseInt(i),this.completedSessionsEl.textContent=this.completedSessions)}saveStats(){localStorage.setItem("pomodoroStats",this.completedSessions.toString())}}"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission();document.addEventListener("DOMContentLoaded",()=>{new r});
